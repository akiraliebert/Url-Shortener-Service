URL Shortener Service

üìå –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞

–°–µ—Ä–≤–∏—Å —Å–æ–∫—Ä–∞—â–µ–Ω–∏—è —Å—Å—ã–ª–æ–∫ (URL Shortener) –ø–æ–∑–≤–æ–ª—è–µ—Ç –±—ã—Å—Ç—Ä–æ —Å–æ–∫—Ä–∞—â–∞—Ç—å –¥–ª–∏–Ω–Ω—ã–µ URL –∏ —É–ø—Ä–∞–≤–ª—è—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–æ–π –ø–µ—Ä–µ—Ö–æ–¥–æ–≤.
–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º FastAPI, PostgreSQL –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –∏ Redis –¥–ª—è –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è –∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏.

–ö–ª—é—á–µ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:

–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–æ—Ä–æ—Ç–∫–∏—Ö —Å—Å—ã–ª–æ–∫ –ø–æ –¥–ª–∏–Ω–Ω—ã–º URL.

–ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ (redirect) –ø–æ –∫–æ—Ä–æ—Ç–∫–æ–º—É URL.

–ü–æ–¥—Å—á—ë—Ç –∫–ª–∏–∫–æ–≤ –∏ –≤—Ä–µ–º–µ–Ω–∏ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –¥–æ—Å—Ç—É–ø–∞.

–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ URL –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –≤ Redis –¥–ª—è –≤—ã—Å–æ–∫–æ–π –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏.

–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤ –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è —Å—Å—ã–ª–æ–∫.

–ü–æ–ª–Ω–æ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ —Ç–µ—Å—Ç–∞–º–∏ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º pytest –∏ pytest-asyncio.

üèó –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

FastAPI ‚Äî –æ—Å–Ω–æ–≤–Ω–æ–π –≤–µ–±-—Ñ—Ä–µ–π–º–≤–æ—Ä–∫ –¥–ª—è API.

PostgreSQL ‚Äî —Ö—Ä–∞–Ω–µ–Ω–∏–µ –æ—Å–Ω–æ–≤–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —Å—Å—ã–ª–∫–∞—Ö: –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π URL, –∫–æ–¥, –¥–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è, –∫–ª–∏–∫–∏.

Redis ‚Äî –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ—Ä–æ—Ç–∫–∏—Ö —Å—Å—ã–ª–æ–∫ –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ (clicks, last_accessed), —É—Å–∫–æ—Ä–µ–Ω–∏–µ —Ä–µ–¥–∏—Ä–µ–∫—Ç–æ–≤.

Background Tasks ‚Äî –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –∫–ª–∏–∫–æ–≤ –≤ PostgreSQL.

JWT Authentication ‚Äî –∑–∞—â–∏—Ç–∞ —ç–Ω–¥–ø–æ–∏–Ω—Ç–∞ —É–¥–∞–ª–µ–Ω–∏—è —Å—Å—ã–ª–æ–∫.

–ü—Ä–∏–º–µ—Ä —Ä–∞–±–æ—Ç—ã:

POST /api/shorten
-> –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∫–æ—Ä–æ—Ç–∫–∏–π URL

GET /api/{short_code}
-> –†–µ–¥–∏—Ä–µ–∫—Ç –Ω–∞ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π URL, –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏

GET /api/stats/{short_code}
-> –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç clicks –∏ last_accessed

‚öô –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∑–∞–ø—É—Å–∫
1. –ö–ª–æ–Ω–∏—Ä—É–µ–º —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
git clone <repo-url>
cd url_shortener_service

2. –°–æ–∑–¥–∞—ë–º .env —Ñ–∞–π–ª

–ü—Ä–∏–º–µ—Ä —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ .env:

POSTGRES_USER=postgres
POSTGRES_PASSWORD=postgres
POSTGRES_DB=url_shortener
PGADMIN_DEFAULT_EMAIL=admin@example.com
PGADMIN_DEFAULT_PASSWORD=admin
SECRET_KEY=supersecretkey
ACCESS_TOKEN_EXPIRE_MINUTES=30
REDIS_URL=redis://redis:6379/0
REDIS_TTL=3600

3. Docker Compose

–ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤ —á–µ—Ä–µ–∑ Docker:

docker-compose up -d --build


–°–µ—Ä–≤–∏—Å—ã:

db ‚Äî PostgreSQL

pgadmin ‚Äî –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ë–î

url_shortener ‚Äî FastAPI –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ

redis ‚Äî Redis –∫—ç—à

üöÄ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ API
–°–æ–∑–¥–∞–Ω–∏–µ –∫–æ—Ä–æ—Ç–∫–æ–π —Å—Å—ã–ª–∫–∏
POST /api/shorten
Content-Type: application/json

{
  "original_url": "https://example.com/very/long/url"
}


–û—Ç–≤–µ—Ç:

{
  "short_code": "abc123",
  "original_url": "https://example.com/very/long/url"
}

–†–µ–¥–∏—Ä–µ–∫—Ç –ø–æ –∫–æ—Ä–æ—Ç–∫–æ–π —Å—Å—ã–ª–∫–µ
GET /api/abc123


–í–µ—Ä–Ω—ë—Ç —Ä–µ–¥–∏—Ä–µ–∫—Ç –Ω–∞ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π URL.

–û–±–Ω–æ–≤–ª—è–µ—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É clicks –∏ last_accessed –≤ Redis –∏ —Ñ–æ–Ω–æ–≤–æ –≤ PostgreSQL.

–ü–æ–ª—É—á–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
GET /api/stats/abc123


–ü—Ä–∏–º–µ—Ä –æ—Ç–≤–µ—Ç–∞:

{
  "clicks": 10,
  "last_accessed": "2025-10-15T12:45:30"
}

–£–¥–∞–ª–µ–Ω–∏–µ —Å—Å—ã–ª–∫–∏ (—Ç–æ–ª—å–∫–æ –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤)
DELETE /api/abc123
Authorization: Bearer <JWT_TOKEN>


–û—Ç–≤–µ—Ç:

{
  "detail": "URL deleted successfully"
}

üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–¢–µ—Å—Ç—ã –ø–æ–∫—Ä—ã–≤–∞—é—Ç:

–°–æ–∑–¥–∞–Ω–∏–µ –∫–æ—Ä–æ—Ç–∫–∏—Ö —Å—Å—ã–ª–æ–∫

–†–µ–¥–∏—Ä–µ–∫—Ç –∏ –ø—Ä–æ–≤–µ—Ä–∫—É —Å—Ç–∞—Ç—É—Å–∞ HTTP

–ü—Ä–æ–≤–µ—Ä–∫—É —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏

–û–±—Ä–∞–±–æ—Ç–∫—É –¥—É–±–ª–∏–∫–∞—Ç–æ–≤ –∏ –Ω–µ–≤–∞–ª–∏–¥–Ω—ã—Ö URL

–£–¥–∞–ª–µ–Ω–∏–µ —Å—Å—ã–ª–æ–∫ —Å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–µ–π

–ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤:

pytest -v


–î–ª—è —Ä–∞–±–æ—Ç—ã —Ç–µ—Å—Ç–æ–≤ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ñ–∏–∫—Å—Ç—É—Ä–∞ pytest-asyncio —Å –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–º event_loop.

üí° –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

Redis –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —É—Å–∫–æ—Ä–µ–Ω–∏—è –¥–æ—Å—Ç—É–ø–∞ –∫ —Å—Å—ã–ª–∫–∞–º –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–µ, –º–∏–Ω–∏–º–∏–∑–∞—Ü–∏—è –æ–±—Ä–∞—â–µ–Ω–∏–π –∫ PostgreSQL.

Background tasks –æ–±–Ω–æ–≤–ª—è—é—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –∫–ª–∏–∫–æ–≤ –≤ –ë–î –±–µ–∑ –∑–∞–¥–µ—Ä–∂–∫–∏ —Ä–µ–¥–∏—Ä–µ–∫—Ç–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

JWT –∑–∞—â–∏—Ç–∞ –¥–ª—è DELETE —ç–Ω–¥–ø–æ–∏–Ω—Ç–∞.

–ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –Ω–∞ –±–∞–∑–µ asyncpg –∏ redis.asyncio.

–ü–æ–ª–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –≤–∞–ª–∏–¥–Ω–æ—Å—Ç—å URL –∏ –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤.

üõ† –°—Ç–µ–∫ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π

Python 3.12

FastAPI

PostgreSQL 15

Redis 7+

SQLAlchemy + AsyncSession

Redis.asyncio

Passlib (–¥–ª—è —Ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è –ø–∞—Ä–æ–ª–µ–π)

JWT (PyJWT / python-jose)

Pytest + pytest-asyncio

üìå –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ

–í—Å–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –±–µ—Ä—É—Ç—Å—è –∏–∑ .env.

Redis TTL –Ω–∞ –∫—ç—à –º–æ–∂–Ω–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é REDIS_TTL.

–§–∏–∫—Å—Ç—É—Ä—ã —Ç–µ—Å—Ç–æ–≤ –∏—Å–ø–æ–ª—å–∑—É—é—Ç –≤—Ä–µ–º–µ–Ω–Ω—É—é –±–∞–∑—É SQLite –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –∏ –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è.

–í—Å–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã –≤–µ—Ä—Å–∏–æ–Ω–∏—Ä—É—é—Ç—Å—è —á–µ—Ä–µ–∑ /api/.
